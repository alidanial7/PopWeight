# Cursor Rules for PopWeight Project

## Project Context

- Always read the README.md file at the start of any task to understand the project goals, methodology, and context.
- This project implements a data-driven framework for learning dynamic engagement weights (α, β, γ) for social media content popularity prediction.
- The project uses log-log normalization and compares against fixed-weight baseline models.

## Key Project Details

- Dataset: Social Media Engagement Report with Likes, Comments, Shares, and Reach/Impressions
- Goal: Learn optimal weights for engagement metrics instead of using fixed formulas

## Code Guidelines

- Follow Python best practices and maintain clean, readable code
- Use type hints where appropriate
- Document functions and classes clearly
- Ensure code aligns with the research methodology described in the README

## Ruff Linting Rules

This project uses Ruff for linting and formatting. **ALWAYS** ensure code passes Ruff checks:

### Line Length
- **Maximum line length: 79 characters** (strict limit for Ruff E501)
- If a line exceeds 79 characters, break it into multiple lines
- For complex calculations in f-strings, extract variables first:
  ```python
  # ❌ Bad (line too long)
  print(f"Scale Ratio: {sample_df[predicted_col].mean() / (sample_df[actual_col].mean() + 1e-10):.4f}")
  
  # ✅ Good (extract variables)
  pred_mean = sample_df[predicted_col].mean()
  actual_mean = sample_df[actual_col].mean()
  scale_ratio = pred_mean / (actual_mean + 1e-10)
  print(f"Scale Ratio: {scale_ratio:.4f}")
  ```
- For imports, use multi-line format when needed:
  ```python
  from utils import (
      function1,
      function2,
      function3,
  )
  ```
- For long strings, assign to variables:
  ```python
  long_string = (
      "This is a very long string that would exceed "
      "the line length limit if written on one line"
  )
  ```

### Unused Variables
- **B007**: Never use loop variables that aren't used in the loop body
- Use `_` (underscore) for unused loop variables:
  ```python
  # ❌ Bad
  for i in range(10):
      do_something()
  
  # ✅ Good
  for _ in range(10):
      do_something()
  ```

### Code Quality Rules
- **E501**: Line too long - Always break long lines
- **B007**: Loop control variable not used - Use `_` for unused variables
- **F**: Pyflakes errors - Fix all undefined names, unused imports, etc.
- **E/W**: Pycodestyle errors/warnings - Follow PEP 8 style guide
- **I**: Import sorting - Imports are automatically sorted by isort

### Best Practices
1. **Before committing**: Run `ruff check .` to verify no errors
2. **Long strings**: Break into variables or use string concatenation
3. **Long function calls**: Break arguments across multiple lines
4. **Docstrings**: Keep usage examples under 88 characters per line
5. **Type hints**: Always include type hints for function parameters and return types

### Automatic Fixes
- Ruff can auto-fix many issues with `ruff check --fix .`
- Format code with `ruff format .`
- Pre-commit hooks will run these automatically on commit

## Documentation Maintenance

### README Updates
- **After each response**: Check if README needs updates based on code changes
- **When adding features**: Update relevant README files:
  - Main `README.md` for high-level changes
  - `workflows/README.md` for workflow changes
  - `utils/README.md` for utility function changes
  - `analysis/README.md` for analysis module changes
- **When modifying functions**: Update function documentation in the appropriate README
- **Keep links current**: Ensure all cross-references between READMEs are accurate
- **Documentation structure**: 
  - Main README: Overview, quick start, project structure, links to sub-READMEs
  - Sub-READMEs: Detailed API documentation, examples, usage patterns
